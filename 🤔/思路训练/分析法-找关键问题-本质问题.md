问题背景:

字段存数据库的列名不能有特殊字符,比如 `.` `$` ,因此,在存数据库前需要将特殊字符替换成合法字符. 暂定为 _

(旧设计字段前加 `$` 表示保留字段.且只会作为开头.   `.`  作为分隔符作为限定名 )

按照上述的规则, 以下两个字段`abc.$ip` `abc._ip` 都将被转成 `abc__ip`, 作为列名, 必然存在重复列.

因此, 需要一种方案将全限定字段名转为列名



分析问题关键:

**上面的示例为 `$` 替换成 `_` 与用户输入 `_` 无法区分**

抽象地分析上面一句话 **上面的示例为 `$` 替换后的字符 与用户输入的前缀**

因此,问题的关键实际是是设置一个 `$` 的转化字符让它不可能是用户输入就行了.

合法字段的定义跟 c 语言变量一样,不能以数字开头, 因此,`$`转化成数字开头的就能和用户输入正交. 比如转化成 0.



问题的本质实际上是找到一个正交前缀区分这两种情况.

如何找关键问题呢? 先用自己的话描述一下特例的情况, 然后将这句话模板化.  将可以变的 比如这里的 `_` 引入一个概念, 然后再带入其中.

精简精简关键问题就出来了.



主要矛盾变成了替换后的与原本的无法区分.  找到了问题, 解决起来就比较容易.

上面的是利用其他条件构造正交前缀.但是吧, 自己定义正交前缀就更直观.

`$`替换的使用 `s_`

用户自己的用 `u_`

这样, `abc.$ip` `abc._ip`  就能被映射成 `abc.s_ip` `abc.u__ip` . 可见.



本质问题是让两个字符串不相等, 如果两个字符串相等,还要做区分,那么就加前缀.

